#!/usr/bin/env node

const { spawn } = require('child_process');
const path = require('path');

// Get the directory where this script is located
const scriptDir = __dirname;
const distPath = path.join(scriptDir, '..', 'dist', 'index.js');

// Check if the compiled version exists
const fs = require('fs');
if (!fs.existsSync(distPath)) {
  console.log('Building AURA...');
  const buildProcess = spawn('pnpm', ['run', 'build'], {
    cwd: path.join(scriptDir, '..'),
    stdio: 'inherit'
  });
  
  buildProcess.on('close', (code) => {
    if (code === 0) {
      console.log('Build completed successfully!');
      require(distPath);
    } else {
      console.error('Build failed!');
      process.exit(1);
    }
  });
} else {
  require(distPath);
} 